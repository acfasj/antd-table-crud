(this["webpackJsonpantd-table-crud"]=this["webpackJsonpantd-table-crud"]||[]).push([[0],{171:function(e,t,a){e.exports=a(318)},176:function(e,t,a){},179:function(e,t,a){},318:function(e,t,a){"use strict";a.r(t);var n,r=a(0),o=a.n(r),i=a(26),c=a.n(i),u=(a(176),a(32)),s=a(40),l=a(35),d=a.n(l),p=a(47),f=a(321),m=a(323),b=a(325),v=a(41),g=a(319),h=a(93),y=a.n(h);a(179);function E(e,t){return Math.floor(Math.random()*(t-e+1))+e}function O(e){return new Promise((function(t){setTimeout(t,e||E(100,1200))}))}!function(e){e[e.Draft=0]="Draft",e[e.Published=1]="Published"}(n||(n={}));var w=new Array(200).fill(0).map((function(e,t){return{id:200-t,title:"post - ".concat(200-t),content:"abcdefghijklmnopqrstuvwxyz".slice(E(0,8),E(14,25)),status:E(0,1),order:E(1,20),createdAt:Date.now(),updatedAt:Date.now()}}));function j(e){for(var t,a=arguments.length,n=new Array(a>1?a-1:0),r=1;r<a;r++)n[r-1]=arguments[r];(t=console).log.apply(t,["%c ".concat(e),"background: #222; color: #bada55"].concat(n))}function x(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];j.apply(void 0,["=================== Request => "].concat(t))}function S(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];j.apply(void 0,["=================== Response => "].concat(t))}function k(){return C.apply(this,arguments)}function C(){return(C=Object(p.a)(d.a.mark((function e(){var t,a,n,r,o,i,c,u,s,l,p,f,m=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.length>0&&void 0!==m[0]?m[0]:{},a=t.page,n=void 0===a?1:a,r=t.pageSize,o=void 0===r?20:r,i=t.title,c=t.status,u=t.order,x("getPosts",t),e.next=5,O();case 5:return l=(s=(n-1)*o)+o,p=w.concat(),i&&(p=p.filter((function(e){return e.title.includes(i)}))),(c||0===c)&&(p=p.filter((function(e){return e.status===c}))),(u||0===u)&&p.sort((function(e,t){return 0===u?e.order-t.order:t.order-e.order})),S("getPosts",f={list:p.slice(s,l),pagination:{total:p.length,page:n,pageSize:o}}),e.abrupt("return",f);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){return A.apply(this,arguments)}function A(){return(A=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x("deletePost",t),e.next=3,O();case 3:w=w.filter((function(e){return e.id!==t})),S("deletePost");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e){return q.apply(this,arguments)}function q(){return(q=Object(p.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S("createPost",t),e.next=3,O();case 3:return a=w[0].id+1,w.unshift(Object(u.a)(Object(u.a)({},t),{},{id:a,createdAt:Date.now(),updatedAt:Date.now()})),S("createPost",w),e.abrupt("return",{id:a});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){return z.apply(this,arguments)}function z(){return(z=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x("updatePost",t),e.next=3,O();case 3:w=w.map((function(e){return e.id===t.id?Object(u.a)(Object(u.a)({},e),JSON.parse(JSON.stringify(t))):e})),S("updatePost");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){return F.apply(this,arguments)}function F(){return(F=Object(p.a)(d.a.mark((function e(t){var a,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x("batchUpdatePost",t),e.next=3,O();case 3:a=t.ids,n=t.status,w=w.map((function(e){return a.includes(e.id)?Object(u.a)(Object(u.a)({},e),{},{status:n}):e})),S("batchUpdatePost");case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){var t=Number.parseInt(e,10);return Number.isNaN(t)?void 0:t}function N(e,t,a){return Math.min(Math.max(e,t),a)}var U=a(320),T=a(322);function Q(e){var t=e.onSubmit,a=e.onReset,n=e.defaultQuery,r=U.a.useForm(),i=Object(s.a)(r,1)[0];return o.a.useEffect((function(){if(n){var e=n.title;e&&i.setFieldsValue({title:e})}}),[i,n]),o.a.createElement(U.a,{form:i,layout:"inline",onFinish:t},o.a.createElement(U.a.Item,{name:"title",label:"\u6807\u9898"},o.a.createElement(T.a,{placeholder:"\u6587\u7ae0\u6807\u9898",maxLength:10})),o.a.createElement(v.a,{htmlType:"submit",type:"primary"},"\u641c\u7d22"),o.a.createElement(v.a,{htmlType:"button",onClick:function(){i.resetFields(),a({title:void 0})}},"\u91cd\u7f6e"))}var B=a(108),J=a(324);function V(e){var t=e.visible,a=e.onCancel,r=e.onCreate,i=e.onUpdate,c=e.loading,l=e.record,d=e.title,p=U.a.useForm(),m=Object(s.a)(p,1)[0];return o.a.useEffect((function(){t&&m.setFieldsValue({title:null===l||void 0===l?void 0:l.title,content:null===l||void 0===l?void 0:l.content,status:l?l.status:n.Draft,order:(null===l||void 0===l?void 0:l.order)||1})}),[l,m,t]),o.a.createElement(f.a,{forceRender:!0,title:d,visible:t,onCancel:a,onOk:function(){m.validateFields().then((function(e){l?i&&i(Object(u.a)(Object(u.a)({},e),{},{id:l.id})):r&&r(e)}))},okButtonProps:{loading:c}},o.a.createElement(U.a,{form:m,labelCol:{span:6},wrapperCol:{span:18}},o.a.createElement(U.a.Item,{name:"title",label:"title",rules:[{required:!0,message:"title is required"}]},o.a.createElement(T.a,null)),o.a.createElement(U.a.Item,{name:"content",label:"content",rules:[{required:!0,message:"content is required"}]},o.a.createElement(T.a.TextArea,null)),o.a.createElement(U.a.Item,{name:"status",label:"status",required:!0},o.a.createElement(B.a.Group,null,o.a.createElement(B.a,{value:n.Draft},"draft"),o.a.createElement(B.a,{value:n.Published},"published"))),o.a.createElement(U.a.Item,{name:"order",label:"order",rules:[{required:!0,message:"order is required"}]},o.a.createElement(J.a,{min:1}))))}function G(e){var t=e.visible,a=e.onCancel,r=e.onSubmit,i=e.loading,c=e.records,l=U.a.useForm(),m=Object(s.a)(l,1)[0];return o.a.useEffect((function(){t&&m.resetFields()}),[t,m]),o.a.createElement(f.a,{forceRender:!0,title:"\u6279\u91cf\u66f4\u65b0\u6587\u7ae0\u72b6\u6001",visible:t,onCancel:a,onOk:function(){m.validateFields().then(function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(Object(u.a)(Object(u.a)({},t),{},{ids:c.map((function(e){return e.id}))}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},okButtonProps:{loading:i}},o.a.createElement(U.a,{form:m,labelCol:{span:6},wrapperCol:{span:18}},o.a.createElement(U.a.Item,{name:"remark",label:"remark",rules:[{required:!0,message:"remark is required"}]},o.a.createElement(T.a.TextArea,{placeholder:"\u586b\u5199\u5907\u6ce8"})),o.a.createElement(U.a.Item,{name:"status",label:"status",required:!0,initialValue:n.Draft},o.a.createElement(B.a.Group,null,o.a.createElement(B.a,{value:n.Draft},"draft 0"),o.a.createElement(B.a,{value:n.Published},"published 1")))))}function K(){var e=y.a.parse(window.location.search,{ignoreQueryPrefix:!0}),t=e.page,a=e.pageSize,n=e.title,r=e.status,o=e.order,i={};if("string"===typeof t&&(i.page=R(t)||1),"string"===typeof a&&(i.pageSize=R(a)||20),"string"===typeof n&&(i.title=n),"string"===typeof r&&(i.status=R(r)),"string"===typeof o){var c=R(o);i.order=c?N(c,0,1):void 0}return i}var W=function(){var e,t=o.a.useState(K),a=Object(s.a)(t,1)[0],n=function(e,t){var a=o.a.useState(t),n=Object(s.a)(a,2),r=n[0],i=n[1],c=o.a.useState({list:[],pagination:{page:1,pageSize:20,total:0}}),u=Object(s.a)(c,2),l=u[0],d=u[1],p=o.a.useState(!1),f=Object(s.a)(p,2),m=f[0],b=f[1];return o.a.useEffect((function(){var t=!0;return b(!0),e(r).then((function(e){return t&&d(e)})).finally((function(){return t&&b(!1)})),function(){t=!1}}),[r]),{query:r,setQuery:i,data:l,loading:m}}(k,a),r=n.data,i=n.query,c=n.setQuery,l=n.loading,h=o.a.useState(),E=Object(s.a)(h,2),O=E[0],w=E[1],j=o.a.useState([]),x=Object(s.a)(j,2),S=x[0],C=x[1],A=o.a.useState(""),q=Object(s.a)(A,2),z=q[0],F=q[1],R=o.a.useState(!1),U=Object(s.a)(R,2),T=U[0],B=U[1],J=function(){F(""),w(void 0),C([])},W=function(e){var t=e.api,a=e.successMessage,n=void 0===a?"\u64cd\u4f5c\u6210\u529f":a,r=e.errorMessage,o=void 0===r?"\u64cd\u4f5c\u5931\u8d25":r;return Object(p.a)(d.a.mark((function e(){var a=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B(!0),e.prev=1,e.next=4,t.apply(void 0,a);case 4:m.b.success(n),c((function(e){return Object(u.a)({},e)})),J(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),m.b.error(o);case 12:return e.prev=12,B(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,9,12,15]])})))},L=[{dataIndex:"id",title:"id"},{dataIndex:"title",title:"title"},{dataIndex:"content",title:"content"},{dataIndex:"status",title:"status",filters:[{text:"0",value:0},{text:"1",value:1}],filterMultiple:!1,filteredValue:void 0===i.status?void 0:[i.status.toString()]},{dataIndex:"order",title:"order",sorter:!0,sortOrder:void 0===i.order?void 0:{0:"ascend",1:"descend"}[i.order]},{dataIndex:"createdAt",title:"createdAt",sorter:!0},{dataIndex:"updatedAt",title:"updatedAt"},{title:"\u64cd\u4f5c",render:function(e,t){return o.a.createElement(b.b,null,o.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){w(t),F("update")}},"\u7f16\u8f91"),o.a.createElement("span",{style:{color:"red",cursor:"pointer"},onClick:function(){return function(e,t){f.a.confirm({title:"Delete Post",content:o.a.createElement("p",null,"\u786e\u5b9a\u5220\u9664 ",e.title," \u5417?"),onOk:function(){var a=Object(p.a)(d.a.mark((function a(){return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,P(e.id);case 3:m.b.success("\u5220\u9664\u6210\u529f"),t(),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),m.b.error("\u5220\u9664\u5931\u8d25");case 10:case"end":return a.stop()}}),a,null,[[0,7]])})));return function(){return a.apply(this,arguments)}}()})}(t,(function(){return c((function(e){var t=e.page||1;return Object(u.a)(Object(u.a)({},e),{},{page:1===r.list.length?N(t-1,1,t):t})}))}))}},"\u5220\u9664"))}}];return function(e,t){var a=o.a.useRef(t);o.a.useEffect((function(){var t=window.location,n=t.protocol,r=t.host,o=t.pathname,i="".concat(n,"//").concat(r).concat(o,"?").concat(y.a.stringify(e,a.current));window.history.replaceState(null,"",i)}),[e])}(i),o.a.createElement("div",null,o.a.createElement("h1",null,"antd table crud"),o.a.createElement(Q,{defaultQuery:a,onSubmit:function(e){return c((function(t){return Object(u.a)(Object(u.a)(Object(u.a)({},t),e),{},{page:1})}))},onReset:function(e){return c((function(t){return Object(u.a)(Object(u.a)(Object(u.a)({},t),e),{},{page:1})}))}}),o.a.createElement("div",{style:{margin:"15px 0"}},o.a.createElement(b.b,null,o.a.createElement(v.a,{type:"primary",onClick:function(){return F("create")}},"Create"),o.a.createElement(v.a,{type:"primary",disabled:S.length<=0,onClick:function(){F("batchUpdateStatus")}},"\u6279\u91cf\u66f4\u65b0\u6587\u7ae0\u72b6\u6001"))),o.a.createElement(g.a,{rowKey:"id",dataSource:r.list,columns:L,loading:l,pagination:Object(u.a)({},(e=r.pagination,{current:e.page,total:e.total,pageSize:e.pageSize,showTotal:function(){return"\u6bcf\u9875".concat(e.pageSize,"\u6761\u6570\u636e\uff0c\u5171").concat(e.total,"\u6761")}})),onChange:function(e,t,a){c((function(n){return Object(u.a)(Object(u.a)({},n),{},{page:e.current||1,pageSize:e.pageSize||20,status:t.status&&t.status.length>0?Number(t.status[0]):void 0,order:!Array.isArray(a)&&a.order&&"order"===a.field?{ascend:0,descend:1}[a.order]:void 0})}))},rowSelection:{selectedRowKeys:S.map((function(e){return e.id})),onChange:function(e,t){return C(t)}}}),o.a.createElement(V,{title:"Create Post",visible:"create"===z,onCreate:W({api:I,successMessage:"\u521b\u5efa\u6210\u529f",errorMessage:"\u521b\u5efa\u5931\u8d25"}),onCancel:J,loading:T}),o.a.createElement(V,{title:"Update Post",record:O,visible:"update"===z,onUpdate:W({api:M,successMessage:"\u7f16\u8f91\u6210\u529f",errorMessage:"\u7f16\u8f91\u5931\u8d25"}),onCancel:J,loading:T}),o.a.createElement(G,{visible:"batchUpdateStatus"===z,records:S,loading:T,onCancel:J,onSubmit:W({api:D,successMessage:"\u6279\u91cf\u7f16\u8f91\u6210\u529f",errorMessage:"\u6279\u91cf\u7f16\u8f91\u5931\u8d25"})}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(W,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[171,1,2]]]);
//# sourceMappingURL=main.3947d70c.chunk.js.map